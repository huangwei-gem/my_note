## 影刀是什么？
软件机器人的开发平台，搭建自己的个性化的机器人。


## 为什么要用影刀
因为影刀可以帮我们去做那些==***简单且重复***==的工作，从而解放生产力。让我们不要被困在重复的工作中，而是去做一些更有创造力的事情。

适合的场景：
1. 大量重复，只有今天这一次就算了
2. 由很清晰的逻辑规则
3. 跨平台，跨软件的






## 界面的介绍
其实很简单就是像搭积木一样，左边是积木，右边是成品，从左边往右边拖拽就能实现成品。
![[Pasted image 20251104183435.png]]


## 网页

### 网页对象
网页对象：操作的背景
- 刚打开了很多的网页的时候记得命名的时候要易于区分

每一个组件都有对应的介绍的，不记得看一下就行
![[Pasted image 20251104195900.png]]


这记忆是一个基本的流程，获取已打开的网页对象其实就是获取当前网页，也就是和上一步的点击链接相呼应了，一般这俩步是一起的。
![[Pasted image 20251104201240.png]]


### 网页元素

网页元素：就是我们的操作对象

网页的元素要捕获来才行。
![[Pasted image 20251104201652.png]]


捕获相似元素：就是点击2个相似的元素，他会自动的获取相似的元素


![[Pasted image 20251104201946.png]]


### 获取最大的页数
可以先把所有的元素都获取到，然后存起来，取出倒数第二个数字就行
![[Pasted image 20251104205641.png]]


### 对话框
对话框其实就是input

![[Pasted image 20251104210057.png]]


### 等待
等待一般是等待网页加载出来，这个也是常用的，因为一般点击之后要等待元素，而不是立马点，也不是等待几秒，不然可能会没加载出来或者浪费时间。

- 间隔等待是让我们的操作更像人，避免被被网站认为是机器人，从而避免法律纠纷。主要是用在循环爬取网页的数据的时候用。
- 

可以用一个无限循环来监控某一个东西，比如说监控某个人发微信，这个相当于不断循环等待对应的状态有没有出现。
![[Pasted image 20251105001108.png]]

## 模拟人工输入

基本上每一块都有一个模拟人工输入的按钮，模拟人工输入就是和人的行为完全一模一样的，虽然可以规避反爬，但是有俩个缺点：
- 速度慢，因为是手动输入的。
- 容易受干扰，要是突然一个 弹窗遮住了页面，他就不会动了
 

![[Pasted image 20251109133450.png]]




## 从父元素种获取子元素
使用场景：
我们想要捕获这个大框，但是鼠标点击不到
![[Pasted image 20251118182418.png]]


解决办法：
1. 先点击小框
![[Pasted image 20251118183015.png]]

2. 点击元素编辑，**==一般是把最后一个元素去掉就行了，因为一般最后一个元素是子元素==**

![[Pasted image 20251118183814.png]]


3. 然后就可以做对应操作了，一般的流程是：
   - 点获取父亲元素，也就是那一整行，然后再

![[Pasted image 20251118185259.png]]


举个例子：
要先获取一整行的数据，然后循环相似元素，再检查一下是不是完成，如果是完成的话就可以点击发货
![[Pasted image 20251118190732.png]]
这是完整的过程
![[Pasted image 20251118185259.png]]



## 关联元素
其实就是把静态的变成动态的：

举例：
如果要是以后都这样，我们就可以依次点击名称，颜色，价格输入就行了 ，但是如果说有意见商品是没有颜色的呢，那运行点击颜色这个按键就会报错，所以说这个时候就需要一个动态元素，我们可以识别这个元素的名称是什么，然后填入对应的值，**==然后再填入父级元素或者子级元素，就可以解决这个办法==**
![[Pasted image 20251119151439.png]]



## 深度捕获
适用场景：当网页不是标准元素或者其他原因就可以深度捕获
比如这个：这个明明是网页对话框，但是识别不到，导致捕获补不到元素，所以我们点击深度捕获才能捕获
![[Pasted image 20251123120921.png]]


深度捕获的原理其实就是根据windows窗口来设计的，类似与pixpin，是最高优先级的捕获
深度捕获在这里：
![[Pasted image 20251123121155.png]]



## 影刀访问本地静态网页
一定要开一个这样的选项：
![[Pasted image 20251123121251.png]]




## 翻页

一般是识别相似元素获取到一个数组，然后从数组中取倒数第二个，从而获取到页码，接下来循环页码的次数就行了
![[Pasted image 20251123190500.png]]


## 先抓后搜
业务场景：要抓取所有已发货状态，并且是篮球鞋，然后才点确认发货。
如果先搜索发货的话，还要判断是不是篮球鞋，再点发货，这个不仅有点慢，而且逻辑会有一点复杂。（先搜后抓的模式，这是我们一般人的思考范式）

这个时候我们可以先抓取搜索篮球鞋的id号，这样搜索出来就只有一个商品，就只要判断他是不是发货状态就行了，没有什么相似元素组和嵌套的逻辑关系之类的。


## 通用性的问题
比如说这个xpath能识别打一个页面，但是到了另外一个页面就识别不到了，这其实就是徐也好xpath或者bueatifulsuop就行了。












